{
  "info": {
    "name": "TaskFlow API - Complete Testing Flow",
    "_postman_id": "taskflow-api-collection",
    "description": "Complete API testing collection for PDF Upload → Notes → Quizzes flow",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "1. Upload PDF",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "// Save response data for next requests",
              "if (pm.response.code === 200 || pm.response.code === 201) {",
              "    const jsonData = pm.response.json();",
              "    pm.collectionVariables.set('fileId', jsonData.id);",
              "    pm.collectionVariables.set('jobId', jsonData.jobId);",
              "    console.log('File ID:', jsonData.id);",
              "    console.log('Job ID:', jsonData.jobId);",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [],
        "body": {
          "mode": "formdata",
          "formdata": [
            {
              "key": "file",
              "type": "file",
              "src": [],
              "description": "Select your PDF file here"
            },
            {
              "key": "userId",
              "value": "{{userId}}",
              "type": "text",
              "description": "Your user ID"
            },
            {
              "key": "fileName",
              "value": "My Study Document",
              "type": "text",
              "description": "Name for the uploaded file"
            }
          ]
        },
        "url": {
          "raw": "{{baseUrl}}/upload",
          "host": ["{{baseUrl}}"],
          "path": ["upload"]
        },
        "description": "Upload a PDF file. The system will extract text automatically via a background job."
      },
      "response": []
    },
    {
      "name": "2. Generate Notes from PDF Text",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "// Save note data for quiz generation",
              "if (pm.response.code === 200 || pm.response.code === 201) {",
              "    const jsonData = pm.response.json();",
              "    pm.collectionVariables.set('noteId', jsonData.id);",
              "    pm.collectionVariables.set('noteContent', jsonData.content);",
              "    console.log('Note ID:', jsonData.id);",
              "    console.log('Note created successfully!');",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"pdfText\": \"{{pdfText}}\",\n  \"userId\": \"{{userId}}\",\n  \"title\": \"My Study Notes\",\n  \"source\": \"My Study Document.pdf\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{baseUrl}}/ai/generate/notes",
          "host": ["{{baseUrl}}"],
          "path": ["ai", "generate", "notes"]
        },
        "description": "Generate AI-powered study notes from PDF text. Make sure to set the {{pdfText}} variable with extracted PDF content."
      },
      "response": []
    },
    {
      "name": "3. Generate Quiz from Notes",
      "event": [
        {
          "listen": "test",
          "script": {
            "exec": [
              "// Save quiz data",
              "if (pm.response.code === 200 || pm.response.code === 201) {",
              "    const jsonData = pm.response.json();",
              "    pm.collectionVariables.set('quizId', jsonData.id);",
              "    console.log('Quiz ID:', jsonData.id);",
              "    console.log('Quiz created successfully!');",
              "    console.log('Number of questions:', jsonData.questions?.length);",
              "}"
            ],
            "type": "text/javascript"
          }
        }
      ],
      "request": {
        "method": "POST",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"studyNotes\": \"{{noteContent}}\",\n  \"userId\": \"{{userId}}\",\n  \"title\": \"My Quiz\",\n  \"noteId\": \"{{noteId}}\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{baseUrl}}/ai/generate/quiz",
          "host": ["{{baseUrl}}"],
          "path": ["ai", "generate", "quiz"]
        },
        "description": "Generate a quiz from study notes. Uses the note content from the previous step."
      },
      "response": []
    },
    {
      "name": "Get All User Notes",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/notes/user/{{userId}}",
          "host": ["{{baseUrl}}"],
          "path": ["notes", "user", "{{userId}}"]
        },
        "description": "Retrieve all notes for a specific user"
      },
      "response": []
    },
    {
      "name": "Get Specific Note",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/notes/{{noteId}}/user/{{userId}}",
          "host": ["{{baseUrl}}"],
          "path": ["notes", "{{noteId}}", "user", "{{userId}}"]
        },
        "description": "Retrieve a specific note by ID"
      },
      "response": []
    },
    {
      "name": "Get All User Quizzes",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/quizzes/user/{{userId}}",
          "host": ["{{baseUrl}}"],
          "path": ["quizzes", "user", "{{userId}}"]
        },
        "description": "Retrieve all quizzes for a specific user"
      },
      "response": []
    },
    {
      "name": "Get Specific Quiz",
      "request": {
        "method": "GET",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/quizzes/{{quizId}}/user/{{userId}}",
          "host": ["{{baseUrl}}"],
          "path": ["quizzes", "{{quizId}}", "user", "{{userId}}"]
        },
        "description": "Retrieve a specific quiz by ID"
      },
      "response": []
    },
    {
      "name": "Update Quiz Score",
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"score\": 85\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{baseUrl}}/quizzes/{{quizId}}/user/{{userId}}/score",
          "host": ["{{baseUrl}}"],
          "path": ["quizzes", "{{quizId}}", "user", "{{userId}}", "score"]
        },
        "description": "Update the score for a quiz (0-100)"
      },
      "response": []
    },
    {
      "name": "Update Note",
      "request": {
        "method": "PUT",
        "header": [
          {
            "key": "Content-Type",
            "value": "application/json"
          }
        ],
        "body": {
          "mode": "raw",
          "raw": "{\n  \"content\": \"Updated note content here...\",\n  \"title\": \"Updated Title\"\n}",
          "options": {
            "raw": {
              "language": "json"
            }
          }
        },
        "url": {
          "raw": "{{baseUrl}}/notes/{{noteId}}/user/{{userId}}",
          "host": ["{{baseUrl}}"],
          "path": ["notes", "{{noteId}}", "user", "{{userId}}"]
        },
        "description": "Update an existing note"
      },
      "response": []
    },
    {
      "name": "Delete Note",
      "request": {
        "method": "DELETE",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/notes/{{noteId}}/user/{{userId}}",
          "host": ["{{baseUrl}}"],
          "path": ["notes", "{{noteId}}", "user", "{{userId}}"]
        },
        "description": "Delete a specific note"
      },
      "response": []
    },
    {
      "name": "Delete Quiz",
      "request": {
        "method": "DELETE",
        "header": [],
        "url": {
          "raw": "{{baseUrl}}/quizzes/{{quizId}}/user/{{userId}}",
          "host": ["{{baseUrl}}"],
          "path": ["quizzes", "{{quizId}}", "user", "{{userId}}"]
        },
        "description": "Delete a specific quiz"
      },
      "response": []
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:3000",
      "type": "string"
    },
    {
      "key": "userId",
      "value": "test-user-123",
      "type": "string"
    },
    {
      "key": "pdfText",
      "value": "Replace this with your extracted PDF text content...",
      "type": "string"
    },
    {
      "key": "fileId",
      "value": "",
      "type": "string"
    },
    {
      "key": "jobId",
      "value": "",
      "type": "string"
    },
    {
      "key": "noteId",
      "value": "",
      "type": "string"
    },
    {
      "key": "noteContent",
      "value": "",
      "type": "string"
    },
    {
      "key": "quizId",
      "value": "",
      "type": "string"
    }
  ]
}
